version: "3.0"

session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true ######################


#USER INTENTS:
intents:
  - greet
  - completed
  - thanks
  - affirm
  - deny
  #user guidance:
  - bot_challenge
  - ask_guidance
  #main commands:
  - ask_find_product
  - ask_find_supplier
  - ask_wh_update
  #product:
  - ask_stock_info
  - ask_add_to_order
  - inform_text
  - inform_ordinal
  - ask_prodinfo
  - ask_price
  - ask_cat_vat
  - ask_dispmedico
  - ask_compatibility
  - ask_vegan
  - ask_nolactose
  - ask_nogluten
  - ask_nosugar
  #warehouse:
  - inform_pieces
  - inform_decr_pieces
  #supplier:
  - inform_need_order
  - ask_latest_list
  - ask_tot_ordcost
  - ask_make_definitive
  - ask_wh_value
  - ask_get_view


#ENTITIES:
#to be captured by NLU:
entities:
  - pieces


#SLOTS:
slots:
  #basics:
  fail:
    type: bool
    influence_conversation: True
    mappings:
    - type: custom
  
  warehouse:
    type: bool
    influence_conversation: False ###
    mappings:
    - type: custom
  
  recap:
    type: bool
    influence_conversation: False ###
    mappings:
    - type: custom

  #0) data identification:
  p_code:
    type: text
    influence_conversation: True
    mappings:
    - type: from_text
      not_intent: completed
      conditions:
      - active_loop: find_prod_form
        requested_slot: p_code
      - active_loop: wh_update_form
        requested_slot: p_code
      - active_loop: write_order_form
        requested_slot: p_code

  supplier:
    type: text
    influence_conversation: True
    mappings:
    - type: from_text
      not_intent: completed
      conditions:
      - active_loop: find_supplier_form
        requested_slot: supplier
  
  p_name:
    type: text
    influence_conversation: False
    mappings:
    - type: custom
  
  matches:
    type: text
    influence_conversation: False
    mappings:
    - type: custom

  #1) warehouse:
  variation:
    type: categorical
    influence_conversation: False
    values:
    - add
    - decrease
    mappings:
    - type: from_intent
      intent: inform_pieces
      value: add
      conditions:
        - active_loop: wh_update_form
          requested_slot: variation
    - type: from_intent
      intent: inform_decr_pieces
      value: decrease
      conditions:
        - active_loop: wh_update_form
          requested_slot: variation
    - type: from_text
      not_intent:
        - inform_pieces
        - inform_decr_pieces
        - completed
      conditions:
        - active_loop: wh_update_form
          requested_slot: variation
   
  pieces:
    type: float
    influence_conversation: False
    min_value: 0
    max_value: 100
    mappings:
    - type: from_entity
      entity: pieces
      intent: inform_pieces
      not_intent: completed
    - type: from_entity
      entity: pieces
      intent: inform_decr_pieces
      not_intent: completed

  #2) stock:
  need_order:
    type: bool
    influence_conversation: True
    mappings:
    - type: custom

  add_to_order:
    type: bool
    influence_conversation: True
    mappings:
    - type: from_intent
      intent: affirm
      value: True
    - type: from_intent
      intent: inform_pieces
      value: True
    - type: from_intent
      intent: deny
      value: False
    - type: from_text
      not_intent:
        - affirm
        - inform_pieces
        - deny
        - completed

  #3) orders:
  new_list:
    type: bool
    influence_conversation: True
    mappings:
    - type: custom

  ord_code:
    type: float
    influence_conversation: False
    min_value: 0
    mappings:
    - type: custom

  ord_date:
    type: text
    influence_conversation: False
    mappings:
    - type: custom

  ord_list:
    type: text
    influence_conversation: False
    mappings:
    - type: custom

  #3.1) read order:
  keep:
    type: bool
    influence_conversation: False
    mappings:
    - type: from_intent
      intent: affirm
      value: True
      conditions:
        - active_loop: read_order_form
          requested_slot: keep
    - type: from_intent
      intent: inform_pieces
      value: True
      conditions:
        - active_loop: read_order_form
          requested_slot: keep
    - type: from_intent
      intent: deny
      value: False
      conditions:
        - active_loop: read_order_form
          requested_slot: keep
    - type: from_text
      not_intent:
        - affirm
        - inform_pieces
        - deny
        - completed
      conditions:
        - active_loop: read_order_form
          requested_slot: keep
  
  cur_quantity:
    type: float
    influence_conversation: False
    min_value: 0
    mappings:
    - type: custom

  #3.3) suggest_order:
  found:
    type: bool
    influence_conversation: True
    mappings:
    - type: custom

  add_sugg:
    type: bool
    influence_conversation: False
    mappings:
    - type: from_intent
      intent: inform_pieces
      value: True
      conditions:
        - active_loop: suggest_order_form
          requested_slot: add_sugg
    - type: from_intent
      intent: deny
      value: False
      conditions:
        - active_loop: suggest_order_form
          requested_slot: add_sugg
    - type: from_text
      not_intent:
        - inform_pieces
        - deny
        - completed
      conditions:
        - active_loop: suggest_order_form
          requested_slot: add_sugg
  
  #product info:
  category:
    type: text
    influence_conversation: False
    mappings:
    - type: custom
  
  price:
    type: float
    influence_conversation: False
    mappings:
    - type: custom
  
  discount:
    type: float
    influence_conversation: False
    mappings:
    - type: custom
  
  vat:
    type: float
    influence_conversation: False
    mappings:
    - type: custom

  cost:
    type: float
    influence_conversation: False
    mappings:
    - type: custom
  
  tot_cost:
    type: float
    influence_conversation: False
    mappings:
    - type: custom

  tot_value:
    type: float
    influence_conversation: False
    mappings:
    - type: custom
  
  dispmedico:
    type: text
    influence_conversation: False
    mappings:
    - type: custom

  vegan:
    type: text
    influence_conversation: False
    mappings:
    - type: custom

  no_lactose:
    type: text
    influence_conversation: False
    mappings:
    - type: custom

  no_gluten:
    type: text
    influence_conversation: False
    mappings:
    - type: custom

  no_sugar:
    type: text
    influence_conversation: False
    mappings:
    - type: custom


#AGENT'S RESPONSES:
responses:
  utter_happy:
  - text: "Ottimo! Buon lavoro."

  utter_welcome:
  - text: "Di nulla!"
  - text: "Nulla!"
  - text: "Figurati!"
  - text: "Ma di nulla!"
  - text: "Ma figùrati!"

  utter_ready:
  - text: "Sono pronta!"
  - text: "Certo!"
  - text: "Subito!"
  - text: "Certamente!"
  - text: "Va benissimo!"

  utter_ok:
  - text: "Ok!"
  - text: "Perfetto!"
  - text: "Ricevuto!"
  - text: "Va benissimo!"

  utter_iamabot:
  - text: "Sono Herbie, il tuo shop manager digitale. Sono qui per aiutarti a gestire il negozio!"
  - text: "Mi chiamo Herbie! Sono il tuo shop manager digitale. La mia missione è di aiutarti a gestire il negozio!"

  utter_guidance:
  - text: "Memorizza questi 3 comandi: 'trova un prodotto'; 'trova un fornitore'; oppure 'gestisci il magazzino'. Ti guiderò io in tutto!"
  - text: "Usa questi 3 comandi: 'trova un prodotto'; 'trova un fornitore'; oppure 'gestisci il magazzino'. Ti guiderò io!"

  utter_done:
  - text: "Fatto!"
  - text: "Ho completato!"
  - text: "Completato!"
  - text: "Missione compiuta!"

  utter_please_rephrase:
  - text: "Mmm, non ho capito bene. Potresti ripetere?"

  utter_repeat:
  - text: "Potresti ripetere?"
  - text: "Puoi riprovare?"
  - text: "Prova a precisare!"
  - text: "Riprova da capo!"
  - text: "Riprova!"

  utter_specify:
  - text: "Prova a specificare meglio!"
  - text: "A quale ti riferisci?"
  - text: "A quale di questi ti riferisci?"

  utter_skip:
  - text: "Ok, ignoro!"
  - text: "Ok, salto!"

  utter_ask_more:
  - text: "Può servirti altro?"
  - text: "Ti può servire altro?"
  - text: "Posso fare qualcos'altro?"
  - text: "Cos'altro posso fare?"
  - text: "Hai altre domande?"

  utter_ask_what:
  - text: "Cosa vuoi che faccia?"
  - text: "Cosa ti serve?"
  - text: "Cosa ti può servire?"
  - text: "Dimmi cosa posso fare!"
  - text: "Vuoi chiedermi qualcosa?"

  utter_available:
  - text: "Sai dove trovarmi!"
  - text: "Se ti serve altro mi trovi qui."
  - text: "Resto a disposizione!"
  - text: "Chiamami pure quando vuoi!"
  - text: "Alla prossima!"

  #product info:
  utter_ask_p_code:
  - text: "Dimmi il prodotto!"
  - text: "Dimmi pure il prodotto!"
  - text: "Vai col prodotto!"

  #warehouse:
  utter_ask_variation:
  - text: "Mi dici la variazione dei pezzi?"
  - text: "Variazione?"

  utter_ask_pieces:
  - text: "Quanti pezzi?"
  - text: "Mi dici il numero dei pezzi?"
  - text: "Numero di pezzi?"

  utter_ask_next:
  - text: "Andiamo avanti."
  - text: "Prossimo."
  - text: "Continuiamo."
  - text: "Successivo."

  utter_ask_add_to_order:
  - text: "Vuoi che te lo segni come da ordinare?"
  - text: "Lo includo nel prossimo ordine?"
  - text: "Te lo metto in lista per il prossimo ordine?"

  #orders:
  utter_ask_supplier:
  - text: "Mi diresti il nome del produttore?"
  - text: "Qual è il produttore?"
  - text: "Dimmi il nome del produttore!"
  - text: "Quale produttore?"
  
  utter_ready_to_order:
  - text: "Sono pronta a preparare l'ordine!"
  - text: "Prepariamo l'ordine!"

  utter_ask_read:
  - text: "Vuoi che ti rileggo la lista?"
  - text: "Vuoi che io ti legga la lista?"
  - text: "Ti rileggo la lista?"

  utter_ask_keep_piece:
  - text: "Teniamo in lista?"
  - text: "Tengo?"
  - text: "Confermi?"

  utter_ask_add_piece:
  - text: "Aggiungo alla lista?"
  - text: "Aggiungo?"

  utter_ask_sugg_pieces:
  - text: "Quanti pezzi ordino?"
  - text: "Quanti te ne ordino?"
  - text: "Quanti pezzi ordiniamo?"

  #guidance:
  utter_guidance_wo:
  - text: "Ok! Dimmi, uno alla volta, per quali prodotti vuoi aggiornare le giacenze. Inizia col primo."
  - text: "Certo! Dimmi, uno alla volta, per quali prodotti vuoi aggiornare le giacenze. Iniziamo con il primo."

  utter_guidance_read:
  - text: "Ok! Ti leggo i prodotti che abbiamo segnato: dimmi se tenerli o rimuoverli e quanti pezzi vuoi ordinare! Inizio."
  - text: "Ok! Ti leggo la lista: per ogni prodotto, dimmi se tenerlo o rimuoverlo e quanti pezzi vuoi ordinare! Iniziamo."

  utter_guidance_write:
  - text: "Dettami tu, uno alla volta, il nome dei prodotti di {supplier} da ordinare. Iniziamo col primo!"
  - text: "Dettami tu, uno alla volta, i prodotti di {supplier} che vuoi ordinare. Iniziamo!"

  utter_ask_suggest_ord:
  - text: "Posso cercarti i prodotti di {supplier} in esaurimento nel tuo magazzino. Vuoi che te li suggerisca?"
  - text: "Vuoi che ti suggerisca i prodotti di {supplier} in esaurimento nel tuo magazzino?"

  utter_order_ready:
  - text: "Il tuo ordine per {supplier} è pronto!"
  - text: "Abbiamo completato la lista ordini per {supplier}!"

  utter_ask_definitive:
  - text: "Posso confermarti l'ordine come definitivo? Non potrai più modificarlo."
  - text: "Possiamo confermare l'ordine come definitivo? Non potrai più modificarlo."



#AGENT'S CUSTOM ACTIONS:
actions:
  #global slots validation:
  #- action_validate_slot_mappings
  #custom actions:
  #gen:
  - action_reset_all_slots
  - action_reset_ord_slots
  - action_utter_greet
  #prod info:
  - action_utter_prodinfo
  - action_utter_price
  - action_utter_cat_vat
  - action_utter_dispmedico
  - action_utter_compatibility
  - action_utter_vegan
  - action_utter_nolactose
  - action_utter_nogluten
  - action_utter_nosugar
  #orders:
  - action_check_wh
  - action_add_to_list
  - action_get_ordlist
  - action_get_newlist
  - action_get_suggestion_list
  - action_ask_keep
  - action_ask_add_sugg
  - action_utter_tot_ordcost
  - action_mark_definitive
  - action_send_view
  #forms validation:
  - validate_find_prod_form
  - validate_find_supplier_form
  - validate_wh_update_form
  - validate_read_order_form
  - validate_write_order_form
  - validate_suggest_order_form


#FORMS:
forms:
  #finders:
  find_prod_form:
    required_slots:
    - p_code
  
  find_supplier_form:
    required_slots:
    - supplier

  #loopers:
  wh_update_form:
    required_slots:
    - p_code
    - variation
    - pieces

  #make order:  
  #3.1.a. system-driven read:
  read_order_form:
    required_slots:
    - keep

  #3.1.b. user-driven write:
  write_order_form:
    required_slots:
    - p_code
    - pieces

  #3.2. proactive order suggestions:
  suggest_order_form:
    required_slots:
    - add_sugg
